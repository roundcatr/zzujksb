# 郑州大学健康状况上报平台自动填报脚本

仅用于郑州大学健康状况上报平台。

## 背景

自 2020 年初疫情发生以来，学校要求每天通过健康状况上报平台填报健康状况，至今已两年有余。因大多数同学平时在学校没有外出，健康状况极少变化，故编写脚本用于健康状况无变化时的自动化上报。

## **注意**

请勿用此脚本自动化尝试他人信息，服务器配置有反暴力破解措施，此脚本不包含识别图片验证码的模块，多次尝试错误信息会导致服务器要求填写图片验证码而无法填报，甚至导致 IP 被服务器拉黑！

<font color = #FF0000>仅用于个人健康状况及行程信息**未改变且长期稳定**时的自动填报！当健康状况发生改变时请**立即**停止使用脚本并**手动填报**信息，积极配合疫情防控措施！因滥用脚本造成的法律后果自行承担！！</font>

## 兼容性

测试平台：`Ubuntu 20.04`

Python 版本：`3.x`

## 依赖

发送 HTTP 请求需要 `requests` 模块，可通过 `pip list` 检查是否安装。

安装 `requests` 模块：
```
> pip install requests
```

## 配置

`users-available/example.json` 为用户信息样例，

`city` 代表当前所在城市的行政区划代码。脚本中未内置各城市的行政区划代码，可通过搜索引擎检索得到。示例文件中的 `4101` 表示郑州。`address` 表示当前所在详细地址。

`longitude`，`laptitude` 分别表示经度、纬度，样例中为郑州大学钟楼的坐标，请填写真实坐标，随意填写坐标会导致后台判定用户出省，影响请假与销假。

`vaccine` 表示疫苗接种情况，从 `1` 到 `5` 分别代表已接种第一针剂、已接种第二针剂、尚未接种、因禁忌症无法接种、已接种第三针剂。

`cookie` 为自动登录所使用的 cookie，脚本中有自动获取 cookie 的模块，留空即可。

`barkid` 为 iOS 平台利用 Bark 统一推送的设备 ID，可在 iOS 设备上安装 Bark 应用后获取 ID 填入，实现将打卡结果推送到 iOS 设备的功能，避免因程序错误而忘记打卡。

## 使用

原始用户数据存储于 `users-available/`，可存放多个用户，将需要激活的用户数据文件建立软链接于 `users-enabled/` 中即可。
```
$ cd ./users-enabled/
$ ln -s ../users-available/users-to-activate.json ./
```
`reset_pending.sh` 用于每日自动重置待上报的用户，可通过 crond 定时任务自动执行。`.user-pending/` 目录表示待上报的用户，为 `reset_pending.sh` 脚本自动生成，无须手动干预。

为避免请求速度过快导致服务器拒绝响应，建议利用 crond 定时任务间隔 20 分钟以上运行一次 `zzujksb.py`。
